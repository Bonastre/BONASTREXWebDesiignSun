<!-- Three.js Scene Container -->
<div id="three-sceno-container">
  
  <div id="three_canvas_container">
    <div
      id="loading-text"
      style="position: absolute; transform: translate(-50%, -50%); left: 50%; top: 50vh; color: black; font-size: 1.5em; font-weight: 800; z-index: 4; opacity: 1; transition: opacity 0.5s ease-in-out; pointer-events: none;"
    >
    <img src="http://bonastreparis.myshopify.com/cdn/shop/files/Calque_1.svg?v=1724059163&width=500" style="height: 3rem;">
    </div>
    <div id="drag_helper">
      <span style="font-weight: 400; font-size: 15px; margin-top: 0rem;">360</span>
      <img style="height: 2rem; margin-top: -.5rem;" src="{{ 'arrow-circle.png' | asset_url }}">
    </div>
    {% comment %} <img class="smooth_blink_quick" id="three-sceno-container-placeholder" src="{{ '3D_scene_placeholder.jpg' | asset_url }}"> {% endcomment %}
    <video class="smooth_blink_quick" id="three-sceno-container-placeholder" autoplay loop muted playsinline  >
      <source src="{{ '3D_placeholder_vid.mp4' | asset_url }}" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <canvas id="three_canvas"></canvas>
  </div>
</div>

<script>
  const PILIER_NOISE_ASSETS = {
    gros_pilier: 'https://cdn.shopify.com/3d/models/42e049b15291bcdf/gros_low_draco2.glb',
    fin_pilier: 'https://cdn.shopify.com/3d/models/cf0350deb945f112/fin_low_draco2.glb',
    noise1: 'https://cdn.shopify.com/3d/models/25dc66c16d85227b/noise1_low_draco2.glb',
    noise2: 'https://cdn.shopify.com/3d/models/0770eb6204e28935/noise2_low_draco2.glb',
  };
  const BAGS_ASSETS = [
    'https://cdn.shopify.com/3d/models/712ac6f7a7920755/sac_1_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/94749b4835412f61/sac_2_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/f420c02020936738/sac_3_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/8a571b35fe0c4fc0/sac_4_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/bdc5b489eccfbeac/sac_5_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/51656856a055d803/sac_6_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/1bbde890debb509b/sac_7_only-scaled-compressed.glb',
    'https://cdn.shopify.com/3d/models/b99311732e0e1fc6/sac_8_only-scaled-compressed.glb',
  ];
  const BAGS_LINKS = [
    'https://www.bonastre.net/collections/t',
    'https://www.bonastre.net/collections/group_riderbags',
    'https://www.bonastre.net/collections/dome-line',
    'https://www.bonastre.net/collections/the-airbag-line',
    'https://www.bonastre.net/collections/collection-bon-bon',
    'https://www.bonastre.net/collections/ring-crossbody-collection',
    'https://www.bonastre.net/collections/main-collection',
    'https://www.bonastre.net/collections/folder'
  ]

  // event when drag three-sceno-container -> delete drag_helper element (once)
  {% comment %} document.getElementById('three-sceno-container').addEventListener('pointerdown', () => {
    const dragHelper = document.getElementById('drag_helper');
    if (dragHelper) {
      dragHelper.remove();
    }
  },{ once: true }); {% endcomment %}
</script>

<script async src="{{ '3D-sceno.js' | asset_url }}"></script>

<style>
    #three-sceno-container {
      {% comment %} border: solid red 1px; {% endcomment %}
      position: relative;
      background-color: white;
      height: 100vh;
    }

    #three_canvas {
      height: 100vh;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    #three-sceno-title {
      font-family: 'Futura LT';
      letter-spacing: 0.2em;
      font-weight: 800;
      font-size: 2.5rem;
      position: fixed;
      top: 0;
      height: 20rem;
      display: flex;
      justify-content: center;
      align-items: center;
      left: 0%;
      width: 100%;
      text-align: center;
      z-index: 2;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s ease;
    }

    #three_canvas_container {
      {% comment %} border: solid green 1px; {% endcomment %}
      position: absolute;
      top: 0;
      z-index: 1;
      touch-action: auto;
    }

    #drag_helper {
      pointer-events: none;
      position: absolute;
      left: 50%;
      top: 20vh;
      transform: translate(-50%,-50%);
      opacity: 0;
      transition: opacity 1s ease-in-out;
      
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    #three-sceno-container-placeholder {
      position: absolute;
      transform: translate(-50%, -50%);
      height: 90%;
      left: 50%;
      top: 50%;
      filter: blur(8px);
      pointer-events: none;
      opacity: 1;
      transition: opacity 1s ease-in-out;
      z-index: -1 !important;
      max-width: unset !important;
    }

    #three_canvas_container {
      position: relative;
      width: 100%;
      top: 0;
    }

    {% comment %} @media (orientation: portrait) { {% endcomment %}
    @media (pointer: coarse) {
      #drag_helper {
        display: none;
      }

      #three-sceno-container {
        height: 250rem;
      }

      #three_canvas_container {
        position: sticky;
      }

      #three-sceno-container-placeholder {
        transform: translate(-50%, -43%);

      }
    }

    /* blinking */
  .smooth_blink {
    animation: smooth_blinker 2s ease-in-out infinite;
  }

  .smooth_blink_quick {
    animation: smooth_blinker_less_intense 1s ease-in-out infinite;
  }

  @keyframes smooth_blinker {
    0% {
        opacity: 1;
    }

    50% {
        opacity: .2;
    }

    100% {
        opacity: 1;
    }
  }

  @keyframes smooth_blinker_less_intense {
    0% {
        opacity: .8;
    }

    50% {
        opacity: .5;
    }

    100% {
        opacity: .8;
    }
  }
</style>

{% schema %}
{
  "name": "3D-sceno",
  "settings": [],
  "presets": [
    {
      "name": "3D-sceno",
      "category": "Image"
    }
  ]
}
{% endschema %}
